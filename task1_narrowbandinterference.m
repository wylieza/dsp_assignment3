#filter out narrow band interference
#y = audioread("fortroad_lost.wav");
load handel;
fs = 8192; #Audio sampling frequency
num_samples = length(y);

#plot([0:2*pi/num_samples:2*pi-2*pi/num_samples], abs(fft(y)));
#soundsc(y, fs);


a0 = 0.1;
fi = 1024;
w0 = 2*pi/fs*fi;
yc = y + a0*sin(w0*(1:length(y))');

#figure();
plot([0:2*pi/num_samples:2*pi-2*pi/num_samples].*fs/(2*pi), abs(fft(yc)));
soundsc(yc, fs);


impresp = [-0.01240671338741861600, 0.00694358185963385960, 0.02652539108687676200, 0.03401094665800102900, 0.02195785296111492400, -0.00635874014222203090, -0.03671411631501587300, -0.05062669031672122100, -0.03612403146241162400, 0.00344193957770653300, 0.04849139035380394700, 0.07231322279686837300, 0.05632839250782021400, 0.00309968940604096660, -0.06144165779519712000, 0.86111908442223983000, -0.06144165779519712000, 0.00309968940604096660, 0.05632839250782021400, 0.07231322279686837300, 0.04849139035380394700, 0.00344193957770653300, -0.03612403146241162400, -0.05062669031672122100, -0.03671411631501587300, -0.00635874014222203090, 0.02195785296111492400, 0.03401094665800102900, 0.02652539108687676200, 0.00694358185963385960, -0.01240671338741861600];
ycf = conv(yc, impresp);

figure();
plot([0:2*pi/length(ycf):2*pi-2*pi/length(ycf)].*fs/(2*pi), abs(fft(ycf)));

soundsc(ycf, fs);